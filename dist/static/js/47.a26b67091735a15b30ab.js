webpackJsonp([47],{FB2O:function(e,t){},Sx62:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),s=a.n(n),i=a("Dd8w"),l=a.n(i),o=a("exGp"),c=a.n(o),r=a("Mqi+"),d={name:"DeviceSelectModal",props:{visible:{type:Boolean,default:!1}},data:function(){return{loading:!1,tableLoading:!1,deviceList:[],selectedDevice:null,searchParams:{hospitalId:"",sn:"",status:void 0},pagination:{current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e,t){return"第 "+t[0]+"-"+t[1]+" 条/共 "+e+" 条"}},columns:[{title:"设备ID",dataIndex:"deviceId",key:"deviceId"},{title:"医院ID",dataIndex:"hospitalId",key:"hospitalId",scopedSlots:{customRender:"hospitalId"}},{title:"设备类型",dataIndex:"deviceType",key:"deviceType"},{title:"SN码",dataIndex:"sn",key:"sn"},{title:"状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"最后心跳时间",dataIndex:"lastHeartbeat",key:"lastHeartbeat"},{title:"预留字段1",dataIndex:"extendField1",key:"extendField1"},{title:"预留字段2",dataIndex:"extendField2",key:"extendField2"},{title:"预留字段3",dataIndex:"extendField3",key:"extendField3"}],hospitalDict:r.c}},computed:{rowSelection:function(){return{type:"radio",selectedRowKeys:this.selectedDevice?[this.selectedDevice.deviceId]:[],onChange:this.onSelectChange}}},watch:{visible:function(e){e&&this.loadDeviceList()}},methods:{loadDeviceList:function(){var e=this;return c()(s.a.mark(function t(){var a,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.prev=1,a=l()({pageNum:e.pagination.current,pageSize:e.pagination.pageSize},e.searchParams),t.next=5,e.$get("/device/page",a);case 5:(n=t.sent)&&n.data&&(e.deviceList=n.data.records||n.data.list||[],e.pagination.total=n.data.total||0),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),e.$message.error("加载设备列表失败");case 13:return t.prev=13,e.tableLoading=!1,t.finish(13);case 16:case"end":return t.stop()}},t,e,[[1,9,13,16]])}))()},handleSearch:function(){this.pagination.current=1,this.loadDeviceList()},handleReset:function(){this.searchParams={hospitalId:"",sn:"",status:void 0},this.pagination.current=1,this.loadDeviceList()},handleTableChange:function(e){this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.loadDeviceList()},onSelectChange:function(e,t){this.selectedDevice=t.length>0?t[0]:null},handleOk:function(){return this.selectedDevice?"online"!==this.selectedDevice.status?void this.$message.error("只能选择在线状态的设备进行下发"):(this.loading=!0,this.$emit("deviceSelected",this.selectedDevice),void(this.loading=!1)):void this.$message.warning("请选择一个设备")},handleCancel:function(){this.selectedDevice=null,this.$emit("cancel")}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"选择设备",visible:e.visible,confirmLoading:e.loading,width:"1200px",maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("div",{staticClass:"search-area"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:6}},[a("a-input",{attrs:{placeholder:"医院ID",allowClear:""},on:{change:e.handleSearch},model:{value:e.searchParams.hospitalId,callback:function(t){e.$set(e.searchParams,"hospitalId",t)},expression:"searchParams.hospitalId"}})],1),e._v(" "),a("a-col",{attrs:{span:6}},[a("a-input",{attrs:{placeholder:"设备SN码",allowClear:""},on:{change:e.handleSearch},model:{value:e.searchParams.sn,callback:function(t){e.$set(e.searchParams,"sn",t)},expression:"searchParams.sn"}})],1),e._v(" "),a("a-col",{attrs:{span:6}},[a("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"设备状态",allowClear:""},on:{change:e.handleSearch},model:{value:e.searchParams.status,callback:function(t){e.$set(e.searchParams,"status",t)},expression:"searchParams.status"}},[a("a-select-option",{attrs:{value:"online"}},[e._v("在线")]),e._v(" "),a("a-select-option",{attrs:{value:"offline"}},[e._v("离线")]),e._v(" "),a("a-select-option",{attrs:{value:"error"}},[e._v("故障")]),e._v(" "),a("a-select-option",{attrs:{value:"unknown"}},[e._v("未知")])],1)],1),e._v(" "),a("a-col",{attrs:{span:6}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("\n          搜索\n        ")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleReset}},[e._v("\n          重置\n        ")])],1)],1)],1),e._v(" "),a("a-table",{attrs:{columns:e.columns,dataSource:e.deviceList,loading:e.tableLoading,pagination:e.pagination,rowSelection:e.rowSelection,scroll:{y:400},rowKey:"deviceId"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"hospitalId",fn:function(t){return[e._v("\n      "+e._s(e.hospitalDict[t]||t)+"\n    ")]}},{key:"status",fn:function(t){return["online"===t?a("a-tag",{attrs:{color:"green"}},[e._v("在线")]):"offline"===t?a("a-tag",{attrs:{color:"red"}},[e._v("离线")]):"error"===t?a("a-tag",{attrs:{color:"orange"}},[e._v("故障")]):"unknown"===t?a("a-tag",[e._v("未知")]):a("span",[e._v(e._s(t||"-"))])]}}])})],1)},staticRenderFns:[]},u=a("VU/8")(d,h,!1,function(e){a("FB2O")},"data-v-79f86543",null);t.default=u.exports}});