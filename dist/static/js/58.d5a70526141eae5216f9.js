webpackJsonp([58],{"w/5g":function(t,a){},wMQb:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("c/Tr"),r=e.n(i),n=e("lHA8"),s=e.n(n),o=e("Xxa5"),c=e.n(o),l=e("exGp"),d=e.n(l),p={name:"StandardPrescriptionModal",props:{visible:{type:Boolean,default:!1}},data:function(){return{searchKeyword:"",filterIndication1:"",filterIndication2:"",filterPresPart:"",sortBy:"standard_pres_id",selectedStandardId:null,selectedStandardPrescription:null,standardPrescriptions:[],loading:!1,indication1Options:[],indication2Options:[],presPartOptions:[]}},computed:{filteredStandardPrescriptions:function(){var t=this,a=this.standardPrescriptions.filter(function(a){if(t.searchKeyword){var e=t.searchKeyword.toLowerCase();if(!((a.indication1||"")+" "+(a.indication2||"")+" "+(a.indication3||"")+" "+(a.indicationKeyword||"")+" "+(a.presPart||"")).toLowerCase().includes(e))return!1}return!(t.filterIndication1&&a.indication1!==t.filterIndication1||t.filterIndication2&&a.indication2!==t.filterIndication2||t.filterPresPart&&a.presPart!==t.filterPresPart)});return a.sort(function(a,e){return"standard_pres_id"===t.sortBy?(a.standardPresId||0)-(e.standardPresId||0):"pres_part"===t.sortBy?(a.presPart||"").localeCompare(e.presPart||""):(a[t.sortBy]||"").localeCompare(e[t.sortBy]||"")}),a}},watch:{visible:function(t){t&&this.loadStandardPrescriptions()}},methods:{loadStandardPrescriptions:function(){var t=this;return d()(c.a.mark(function a(){var e;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.loading=!0,a.prev=1,a.next=4,t.$get("/standard-prescription/list");case 4:(e=a.sent)&&Array.isArray(e)?t.standardPrescriptions=e:e&&e.data&&Array.isArray(e.data)?t.standardPrescriptions=e.data:e&&e.result&&Array.isArray(e.result)?t.standardPrescriptions=e.result:e&&e.content&&Array.isArray(e.content)?t.standardPrescriptions=e.content:e&&e.data&&e.data.data&&Array.isArray(e.data.data)?t.standardPrescriptions=e.data.data:(t.$message.error("标准处方数据格式异常"),t.standardPrescriptions=[]),t.extractFilterOptions(),a.next=16;break;case 11:a.prev=11,a.t0=a.catch(1),t.$message.error("加载标准处方失败: "+a.t0.message),t.standardPrescriptions=[];case 16:return a.prev=16,t.loading=!1,a.finish(16);case 19:case"end":return a.stop()}},a,t,[[1,11,16,19]])}))()},extractFilterOptions:function(){var t=new s.a,a=new s.a,e=new s.a;this.standardPrescriptions.forEach(function(i,r){i.indication1&&t.add(i.indication1),i.indication2&&a.add(i.indication2),i.presPart&&e.add(i.presPart)}),this.indication1Options=r()(t).sort(),this.indication2Options=r()(a).sort(),this.presPartOptions=r()(e).sort()},selectStandardPrescription:function(t){this.selectedStandardId=t.standardPresId,this.selectedStandardPrescription=t},applySelectedStandardPrescription:function(){this.selectedStandardPrescription?(this.$emit("standardPrescriptionSelected",this.selectedStandardPrescription),this.onCancel()):this.$message.warning("请先选择一个标准处方")},onSearch:function(){},onFilterChange:function(){},onSortChange:function(){},onCancel:function(){this.selectedStandardId=null,this.selectedStandardPrescription=null,this.searchKeyword="",this.filterIndication1="",this.filterIndication2="",this.filterPresPart="",this.$emit("update:visible",!1)}}},v={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-modal",{attrs:{title:"选择标准处方",width:"1200px",footer:null},on:{cancel:t.onCancel},model:{value:t.visible,callback:function(a){t.visible=a},expression:"visible"}},[e("div",{staticClass:"search-section",staticStyle:{"margin-bottom":"20px"}},[e("a-row",{attrs:{gutter:16}},[e("a-col",{attrs:{span:6}},[e("a-input-search",{attrs:{placeholder:"搜索适应症或关键词",allowClear:""},on:{search:t.onSearch},model:{value:t.searchKeyword,callback:function(a){t.searchKeyword=a},expression:"searchKeyword"}})],1),t._v(" "),e("a-col",{attrs:{span:4}},[e("a-select",{attrs:{placeholder:"适应症分类",allowClear:""},on:{change:t.onFilterChange},model:{value:t.filterIndication1,callback:function(a){t.filterIndication1=a},expression:"filterIndication1"}},t._l(t.indication1Options,function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v("\n            "+t._s(a)+"\n          ")])}),1)],1),t._v(" "),e("a-col",{attrs:{span:4}},[e("a-select",{attrs:{placeholder:"具体疾病",allowClear:""},on:{change:t.onFilterChange},model:{value:t.filterIndication2,callback:function(a){t.filterIndication2=a},expression:"filterIndication2"}},t._l(t.indication2Options,function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v("\n            "+t._s(a)+"\n          ")])}),1)],1),t._v(" "),e("a-col",{attrs:{span:4}},[e("a-select",{attrs:{placeholder:"治疗部位",allowClear:""},on:{change:t.onFilterChange},model:{value:t.filterPresPart,callback:function(a){t.filterPresPart=a},expression:"filterPresPart"}},t._l(t.presPartOptions,function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v("\n            "+t._s(a)+"\n          ")])}),1)],1),t._v(" "),e("a-col",{attrs:{span:6}},[e("a-select",{attrs:{placeholder:"排序方式"},on:{change:t.onSortChange},model:{value:t.sortBy,callback:function(a){t.sortBy=a},expression:"sortBy"}},[e("a-select-option",{attrs:{value:"standard_pres_id"}},[t._v("默认排序")]),t._v(" "),e("a-select-option",{attrs:{value:"indication1"}},[t._v("适应症分类")]),t._v(" "),e("a-select-option",{attrs:{value:"pres_part"}},[t._v("治疗部位")]),t._v(" "),e("a-select-option",{attrs:{value:"evidence_level"}},[t._v("证据等级")])],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"prescription-grid",staticStyle:{"max-height":"500px","overflow-y":"auto"}},[t.loading?e("div",{staticStyle:{"text-align":"center",padding:"40px"}},[e("a-spin",{attrs:{size:"large"}}),t._v(" "),e("p",{staticStyle:{"margin-top":"16px",color:"#666"}},[t._v("正在加载标准处方数据...")])],1):0===t.filteredStandardPrescriptions.length?e("div",{staticStyle:{"text-align":"center",padding:"40px"}},[e("a-empty",{attrs:{description:"暂无标准处方数据"}})],1):e("a-row",{attrs:{gutter:16}},t._l(t.filteredStandardPrescriptions,function(a){return e("a-col",{key:a.standardPresId,staticStyle:{"margin-bottom":"16px"},attrs:{span:12}},[e("a-card",{staticClass:"prescription-item",class:{selected:t.selectedStandardId===a.standardPresId},attrs:{hoverable:"",size:"small"},on:{click:function(e){return t.selectStandardPrescription(a)}}},[e("div",{staticClass:"prescription-header"},[e("h4",{staticStyle:{margin:"0 0 8px 0",color:"#1890ff"}},[t._v("\n              "+t._s(a.indication1)+" - "+t._s(a.indication2)+"\n            ")]),t._v(" "),e("div",{staticStyle:{"margin-bottom":"8px"}},[a.indication3?e("a-tag",{attrs:{color:"blue",size:"small"}},[t._v(t._s(a.indication3))]):t._e(),t._v(" "),1===a.builtIn?e("a-tag",{attrs:{color:"green",size:"small"}},[t._v("系统内置")]):e("a-tag",{attrs:{color:"orange",size:"small"}},[t._v("用户自定义")])],1)]),t._v(" "),e("div",{staticClass:"prescription-content"},[e("div",{staticClass:"indication-info",staticStyle:{"margin-bottom":"12px"}},[e("p",{staticStyle:{margin:"0",color:"#666","font-size":"12px"}},[e("strong",[t._v("适应症：")]),t._v(t._s(a.indication1)+" > "+t._s(a.indication2)+"\n                "),a.indication3?e("span",[t._v(" > "+t._s(a.indication3))]):t._e()]),t._v(" "),a.indication_keyword?e("p",{staticStyle:{margin:"4px 0 0 0",color:"#999","font-size":"11px"}},[e("strong",[t._v("关键词：")]),t._v(t._s(a.indication_keyword)+"\n              ")]):t._e()]),t._v(" "),e("div",{staticClass:"params-grid",staticStyle:{"margin-bottom":"12px"}},[e("a-row",{attrs:{gutter:8}},[e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("刺激频率:")]),t._v(" "),e("span",[t._v(t._s(a.presFreq)+"Hz")])])]),t._v(" "),e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("持续时间:")]),t._v(" "),e("span",[t._v(t._s(a.lastTime)+"秒")])])]),t._v(" "),e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("脉冲数量:")]),t._v(" "),e("span",[t._v(t._s(a.lastCount))])])]),t._v(" "),e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("间歇时间:")]),t._v(" "),e("span",[t._v(t._s(a.pauseTime)+"秒")])])]),t._v(" "),e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("重复次数:")]),t._v(" "),e("span",[t._v(t._s(a.repeatCount))])])]),t._v(" "),e("a-col",{attrs:{span:12}},[e("div",{staticClass:"param-item"},[e("label",[t._v("总时间:")]),t._v(" "),e("span",[t._v(t._s(a.totalTime)+"分钟")])])])],1)],1),t._v(" "),e("div",{staticClass:"treatment-info",staticStyle:{"margin-bottom":"8px"}},[e("a-tag",{attrs:{color:"purple",size:"small"}},[t._v(t._s(a.presPart))])],1),t._v(" "),e("div",{staticClass:"evidence-info",staticStyle:{"font-size":"11px",color:"#999"}},[a.evidenceLevel?e("p",{staticStyle:{margin:"0"}},[e("strong",[t._v("证据等级：")]),t._v(t._s(a.evidenceLevel)+"\n              ")]):t._e(),t._v(" "),a.provenance?e("p",{staticStyle:{margin:"4px 0 0 0",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e("strong",[t._v("来源：")]),t._v(t._s(a.provenance)+"\n              ")]):t._e()])])])],1)}),1)],1),t._v(" "),e("div",{staticClass:"modal-footer",staticStyle:{"text-align":"right","margin-top":"20px","padding-top":"16px","border-top":"1px solid #e8e8e8"}},[e("a-button",{on:{click:t.onCancel}},[t._v("取消")]),t._v(" "),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",disabled:!t.selectedStandardId},on:{click:t.applySelectedStandardPrescription}},[t._v("\n      应用选中的标准处方\n    ")])],1)])},staticRenderFns:[]},_=e("VU/8")(p,v,!1,function(t){e("w/5g")},"data-v-65d39983",null);a.default=_.exports}});