webpackJsonp([5,33,55,72],{"08Uw":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Mqi+"),s={name:"DeviceView",props:{deviceShow:{type:Boolean,default:!1},deviceData:{type:Object}},data:function(){return{hospitalDict:i.c}},computed:{show:{get:function(){return this.deviceShow},set:function(){}}},methods:{onClose:function(){this.$emit("close")}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"设备详情",width:850},on:{cancel:e.onClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",attrs:{type:"danger"},on:{click:e.onClose}},[e._v("关闭")])],1),e._v(" "),null!==e.deviceData?a("div",{staticStyle:{"font-size":"13px","font-family":"SimHei"}},[a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[e._v("设备信息")])]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("设备ID：")]),e._v(e._s(e.deviceData.deviceId))]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("医院ID：")]),e._v(e._s(e.hospitalDict[e.deviceData.hospitalId]||e.deviceData.hospitalId))]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("设备类型：")]),e._v(e._s(e.deviceData.deviceType))])],1),e._v(" "),a("br"),e._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[e._v("SN码：")]),e._v(e._s(e.deviceData.sn))]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("状态：")]),e._v(" "),"online"===e.deviceData.status?a("a-tag",{attrs:{color:"green"}},[e._v("在线")]):"offline"===e.deviceData.status?a("a-tag",{attrs:{color:"red"}},[e._v("离线")]):"error"===e.deviceData.status?a("a-tag",{attrs:{color:"orange"}},[e._v("故障")]):"unknown"===e.deviceData.status?a("a-tag",[e._v("未知")]):a("span",[e._v(e._s(e.deviceData.status||"-"))])],1),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("最后心跳时间：")]),e._v(e._s(e.deviceData.lastHeartbeat))])],1),e._v(" "),a("br"),e._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[e._v("预留字段1：")]),e._v(e._s(e.deviceData.extendField1))]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("预留字段2：")]),e._v(e._s(e.deviceData.extendField2))]),e._v(" "),a("a-col",{attrs:{span:8}},[a("b",[e._v("预留字段3：")]),e._v(e._s(e.deviceData.extendField3))])],1)],1):e._e()],2)},staticRenderFns:[]},o=a("VU/8")(s,n,!1,function(e){a("osek")},"data-v-db436bea",null);t.default=o.exports},"7hJW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑设备",width:800},on:{cancel:e.onClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.onClose}},[e._v("取消")]),e._v(" "),a("a-button",{key:"submit",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("修改")])],1),e._v(" "),a("a-form",{attrs:{form:e.form,layout:"vertical"}},[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"医院ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hospitalId",{rules:[{required:!0,message:"请输入医院ID!"}]}],expression:"['hospitalId', { rules: [{ required: true, message: '请输入医院ID!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"设备类型"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deviceType",{rules:[{required:!0,message:"请输入设备类型!"}]}],expression:"['deviceType', { rules: [{ required: true, message: '请输入设备类型!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"SN码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sn",{rules:[{required:!0,message:"请输入SN码!"}]}],expression:"['sn', { rules: [{ required: true, message: '请输入SN码!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段1"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField1"],expression:"['extendField1']"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段2"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField2"],expression:"['extendField2']"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段3"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField3"],expression:"['extendField3']"}]})],1)],1)],1)],1)],2)},staticRenderFns:[]},s=a("VU/8")({name:"DeviceEdit",props:{deviceEditVisiable:{default:!1}},computed:{show:{get:function(){return this.deviceEditVisiable},set:function(){}}},data:function(){return{form:this.$form.createForm(this),loading:!1,rowId:null}},methods:{setFormValues:function(e){this.rowId=e.deviceId;var t={};["hospitalId","deviceType","sn","extendField1","extendField2","extendField3"].forEach(function(a){t[a]=e[a]}),this.form.setFieldsValue(t)},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(t,a){t||(e.loading=!0,a.deviceId=e.rowId,e.$putJson("/device",a).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1}))})}}},i,!1,function(e){a("cguQ")},"data-v-4daa70b2",null);t.default=s.exports},KUzK:function(e,t){},MPN1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),s=a.n(i),n=a("mwGy"),o=a("7hJW"),r=a("08Uw"),d=a("Mqi+"),c={name:"Device",components:{deviceAdd:n.default,deviceEdit:o.default,deviceView:r.default},data:function(){return{deviceAdd:{visiable:!1},deviceEdit:{visiable:!1},deviceView:{visiable:!1,data:null},queryParams:{},dataSource:[],loading:!1,pagination:{pageSizeOptions:["10","20","30","40","100"],current:1,pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,t){return"显示 "+t[0]+" ~ "+t[1]+" 条记录，共 "+e+" 条记录"},total:0},ws:null}},computed:{columns:function(){return[{title:"设备ID",dataIndex:"deviceId"},{title:"医院ID",dataIndex:"hospitalId",customRender:function(e){return d.c[e]||e}},{title:"设备类型",dataIndex:"deviceType"},{title:"SN码",dataIndex:"sn"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"最后心跳时间",dataIndex:"lastHeartbeat"},{title:"预留字段1",dataIndex:"extendField1"},{title:"预留字段2",dataIndex:"extendField2"},{title:"预留字段3",dataIndex:"extendField3"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},methods:{search:function(e,t){var a=this;this.loading=!0;var i=s()({pageNum:e||this.pagination.current,pageSize:t||this.pagination.pageSize},this.queryParams);this.$get("/device/page",i).then(function(e){e&&e.data&&(a.dataSource=e.data.records||e.data.list||[],a.pagination.total=e.data.total||0,a.pagination.current=i.pageNum,a.pagination.pageSize=i.pageSize),a.loading=!1}).catch(function(){a.loading=!1})},reset:function(){this.queryParams={},this.search()},add:function(){this.deviceAdd.visiable=!0},edit:function(e){this.$refs.deviceEdit.setFormValues(e),this.deviceEdit.visiable=!0},remove:function(e){},handleTableChange:function(){},handleDeviceAddClose:function(){this.deviceAdd.visiable=!1},handleDeviceAddSuccess:function(){this.deviceAdd.visiable=!1,this.search()},handleDeviceEditClose:function(){this.deviceEdit.visiable=!1},handleDeviceEditSuccess:function(){this.deviceEdit.visiable=!1,this.search()},handleDeviceViewOpen:function(e){this.deviceView.data=e,this.deviceView.visiable=!0},handleDeviceViewClose:function(){this.deviceView.visiable=!1},initWebSocket:function(){var e=this;this.ws=new WebSocket("ws://127.0.0.1:9527/ws/device"),this.ws.onopen=function(){},this.ws.onmessage=function(t){try{var a=JSON.parse(t.data);if(a.deviceId&&a.status){var i=e.dataSource.find(function(e){return e.deviceId===a.deviceId});i&&e.$set(i,"status",a.status)}}catch(e){}},this.ws.onclose=function(){},this.ws.onerror=function(e){}}},mounted:function(){this.search(),this.initWebSocket()},beforeDestroy:function(){this.ws&&this.ws.close()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{staticClass:"search"},[a("a-form",{attrs:{layout:"horizontal"}},[a("a-row",{attrs:{gutter:15}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"医院ID",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.hospitalId,callback:function(t){e.$set(e.queryParams,"hospitalId",t)},expression:"queryParams.hospitalId"}})],1)],1),e._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"设备SN码",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.sn,callback:function(t){e.$set(e.queryParams,"sn",t)},expression:"queryParams.sn"}})],1)],1),e._v(" "),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.add}},[e._v("新增")])],1),e._v(" "),a("a-table",{attrs:{columns:e.columns,rowKey:function(e){return e.device_id},dataSource:e.dataSource,pagination:e.pagination,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"operation",fn:function(t,i){return[a("a-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"eye",title:"详情"},on:{click:function(t){return e.handleDeviceViewOpen(i)}}}),e._v(" "),a("a-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"edit",title:"编辑"},on:{click:function(t){return e.edit(i)}}}),e._v(" "),a("a-icon",{attrs:{type:"delete",title:"删除"},on:{click:function(t){return e.remove(i)}}})]}},{key:"status",fn:function(t){return["online"===t?a("a-tag",{attrs:{color:"green"}},[e._v("在线")]):"offline"===t?a("a-tag",{attrs:{color:"red"}},[e._v("离线")]):"error"===t?a("a-tag",{attrs:{color:"orange"}},[e._v("故障")]):"unknown"===t?a("a-tag",[e._v("未知")]):a("span",[e._v(e._s(t||"-"))])]}}])})],1),e._v(" "),e.deviceAdd.visiable?a("device-add",{attrs:{deviceAddVisiable:e.deviceAdd.visiable},on:{close:e.handleDeviceAddClose,success:e.handleDeviceAddSuccess}}):e._e(),e._v(" "),a("device-edit",{ref:"deviceEdit",attrs:{deviceEditVisiable:e.deviceEdit.visiable},on:{close:e.handleDeviceEditClose,success:e.handleDeviceEditSuccess}}),e._v(" "),a("device-view",{attrs:{deviceShow:e.deviceView.visiable,deviceData:e.deviceView.data},on:{close:e.handleDeviceViewClose}})],1)},staticRenderFns:[]},u=a("VU/8")(c,l,!1,function(e){a("KUzK")},"data-v-25ba1692",null);t.default=u.exports},cguQ:function(e,t){},eceO:function(e,t){},mwGy:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"新增设备",width:800},on:{cancel:e.onClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.onClose}},[e._v("取消")]),e._v(" "),a("a-button",{key:"submit",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1),e._v(" "),a("a-form",{attrs:{form:e.form,layout:"vertical"}},[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"医院ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hospitalId",{rules:[{required:!0,message:"请输入医院ID!"}]}],expression:"['hospitalId', { rules: [{ required: true, message: '请输入医院ID!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"设备类型"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deviceType",{initialValue:"TMS",rules:[{required:!0,message:"请输入设备类型!"}]}],expression:"['deviceType', { initialValue: 'TMS', rules: [{ required: true, message: '请输入设备类型!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"SN码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sn",{rules:[{required:!0,message:"请输入SN码!"}]}],expression:"['sn', { rules: [{ required: true, message: '请输入SN码!' }] }]"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段1"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField1"],expression:"['extendField1']"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段2"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField2"],expression:"['extendField2']"}]})],1)],1),e._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"预留字段3"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["extendField3"],expression:"['extendField3']"}]})],1)],1)],1)],1)],2)},staticRenderFns:[]},s=a("VU/8")({name:"DeviceAdd",props:{deviceAddVisiable:{default:!1}},computed:{show:{get:function(){return this.deviceAddVisiable},set:function(){}}},data:function(){return{form:this.$form.createForm(this),loading:!1}},methods:{reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this;this.form.validateFields(function(t,a){t||(e.loading=!0,a.status="offline",e.$postJson("/device",a).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1}))})}}},i,!1,function(e){a("eceO")},"data-v-6a2ee402",null);t.default=s.exports},osek:function(e,t){}});